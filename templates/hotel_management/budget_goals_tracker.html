{% extends 'dashboard_base.html' %}
{% load reporting_filters %}

{% block title %}Goals Tracker - {{ hotel.name }} - Benchstay{% endblock %}

{% block content %}
<div class="dashboard-header mb-4">
    <div class="hotel-info d-flex align-items-center">
        <div class="me-4">
            <img src="{{ hotel.logo.url|default:'https://via.placeholder.com/90x90/667eea/ffffff?text=HOTEL' }}" 
                 alt="Hotel Logo" class="hotel-logo">
        </div>
        <div>
            <h1 class="mb-1 fw-bold">Goals Tracker</h1>
            <p class="mb-0 opacity-90">
                <i class="fas fa-hotel me-2"></i>{{ hotel.name }}
            </p>
        </div>
    </div>
 </div>

<div class="card shadow-sm">
    <div class="card-header">
        <div class="d-flex justify-content-between align-items-center">
            <h5 class="card-title mb-0"><i class="fas fa-list-check me-2"></i>All Budget & KPI Goals</h5>
            <a class="btn btn-primary" href="{% url 'hotel_management:budget_goals' %}">
                <i class="fas fa-plus me-2"></i>Add / Edit Goals
            </a>
        </div>
    </div>
    <div class="table-responsive">
        <table class="table performance-table mb-0">
            <thead>
                <tr>
                    <th>Year</th>
                    <th>Period</th>
                    <th>Detail</th>
                    <th class="text-end">Occ %</th>
                    <th class="text-end">ADR</th>
                    <th class="text-end">RevPAR</th>
                    <th class="text-end">Revenue</th>
                    <th class="text-end">MPI</th>
                    <th class="text-end">ARI</th>
                    <th class="text-end">RGI</th>
                    <th>Locked</th>
                    <th>Updated</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                {% for g in goals_list %}
                <tr>
                    <td>{{ g.fiscal_year }}</td>
                    <td>{{ g.get_period_type_display }}</td>
                    <td>{{ g.period_detail|default:'â€”' }}</td>
                    <td class="text-end">{{ g.occupancy_goal|default:'' }}</td>
                    <td class="text-end">{{ system_settings.effective_currency_symbol }} {{ g.adr_goal|default:'' }}</td>
                    <td class="text-end">{{ system_settings.effective_currency_symbol }} {{ g.revpar_goal|default:'' }}</td>
                    <td class="text-end">{{ system_settings.effective_currency_symbol }} {{ g.total_revenue_budget|format_currency_short|default:'' }}</td>
                    <td class="text-end">{{ g.mpi_goal|default:'' }}</td>
                    <td class="text-end">{{ g.ari_goal|default:'' }}</td>
                    <td class="text-end">{{ g.rgi_goal|default:'' }}</td>
                    <td>{% if g.lock_targets %}<span class="badge bg-secondary">Locked</span>{% else %}<span class="badge bg-success">Open</span>{% endif %}</td>
                    <td>{{ g.updated_at|date:'Y-m-d H:i' }}</td>
                    <td class="text-end">
                        <a class="btn btn-sm btn-outline-primary" href="{% url 'hotel_management:budget_goals' %}?fiscal_year={{ g.fiscal_year }}&period_type={{ g.period_type }}&period_detail={{ g.period_detail }}">
                            <i class="fas fa-pen"></i>
                        </a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="13" class="text-center text-muted py-4">No goals defined yet. Click "Add / Edit Goals" to create one.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}


